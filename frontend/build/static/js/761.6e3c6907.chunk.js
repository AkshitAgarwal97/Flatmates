"use strict";(self.webpackChunkflatmates_frontend=self.webpackChunkflatmates_frontend||[]).push([[761],{8761:(e,r,o)=>{o.d(r,{AuthSuccess:()=>O,Login:()=>q,Register:()=>_});var s=o(5043),a=o(3216),n=o(5475),t=o(9456),i=o(5163),l=o(3516),d=o(899),c=o(8202),m=o(1045),u=o(1906),h=o(7784),x=o(4605),g=o(3217),p=o(8446),A=o(3336),j=o(6446),y=o(8903),f=o(5865),w=o(1637),v=o(35),b=o(6600),P=o(5316),C=o(8533),T=o(9347),k=o(6325),B=o(579);const S=d.Ik({email:d.Yj().email("Enter a valid email").required("Email is required"),password:d.Yj().min(6,"Password should be of minimum 6 characters length").required("Password is required")}),q=()=>{const e=(0,c.jL)(),r=(0,a.Zp)(),{isAuthenticated:o,loading:d,error:q}=(0,t.d4)(e=>e.auth),[E,F]=(0,s.useState)(!1),[W,R]=(0,s.useState)({open:!1,message:"",showRegisterButton:!1,showForgotPasswordButton:!1});(0,s.useEffect)(()=>{o&&r("/dashboard")},[o,r]),(0,s.useEffect)(()=>()=>{e((0,i.ET)())},[e]),(0,s.useEffect)(()=>{if(q){var e,r,o,s;if("No token found"===q||"string"===typeof q&&q.includes("No token found"))return;const a="object"===typeof q?q:{errors:[{msg:q}]},n=(null===a||void 0===a||null===(e=a.errors)||void 0===e||null===(r=e[0])||void 0===r?void 0:r.msg)||(null===a||void 0===a?void 0:a.msg)||"Login failed",t=null===a||void 0===a||null===(o=a.errors)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.type;R({open:!0,message:n,showRegisterButton:"USER_NOT_FOUND"===t,showForgotPasswordButton:"INVALID_PASSWORD"===t})}},[q]);const I=()=>{R({open:!1,message:"",showRegisterButton:!1,showForgotPasswordButton:!1}),e((0,i.ET)())},Y=(0,l.Wx)({initialValues:{email:"",password:""},validationSchema:S,onSubmit:r=>{e((0,i.iD)(r))}});return(0,B.jsxs)(y.Ay,{container:!0,component:"main",sx:{height:"100vh"},children:[(0,B.jsx)(y.Ay,{item:!0,xs:!1,sm:4,md:7,sx:{backgroundImage:"url(https://picsum.photos/seed/apartment-login/1600/900)",backgroundRepeat:"no-repeat",backgroundColor:e=>"light"===e.palette.mode?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"}}),(0,B.jsxs)(y.Ay,{item:!0,xs:12,sm:8,md:5,component:A.A,elevation:6,square:!0,children:[(0,B.jsxs)(j.A,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,B.jsx)(m.A,{sx:{m:1,bgcolor:"secondary.main"},children:(0,B.jsx)(k.A,{})}),(0,B.jsx)(f.A,{component:"h1",variant:"h5",children:"Sign in"}),(0,B.jsxs)(j.A,{component:"form",noValidate:!0,onSubmit:Y.handleSubmit,sx:{mt:1,width:"100%"},children:[(0,B.jsx)(h.A,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:Y.values.email,onChange:Y.handleChange,onBlur:Y.handleBlur,error:Y.touched.email&&Boolean(Y.errors.email),helperText:Y.touched.email&&Y.errors.email}),(0,B.jsx)(h.A,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:Y.values.password,onChange:Y.handleChange,onBlur:Y.handleBlur,error:Y.touched.password&&Boolean(Y.errors.password),helperText:Y.touched.password&&Y.errors.password}),(0,B.jsx)(x.A,{control:(0,B.jsx)(g.A,{value:"remember",color:"primary",checked:E,onChange:e=>F(e.target.checked)}),label:"Remember me"}),(0,B.jsx)(u.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:d,children:d?(0,B.jsx)(w.A,{size:24}):"Sign In"}),(0,B.jsxs)(y.Ay,{container:!0,children:[(0,B.jsx)(y.Ay,{item:!0,xs:!0,children:(0,B.jsx)(p.A,{component:n.N_,to:"/forgot-password",variant:"body2",children:"Forgot password?"})}),(0,B.jsx)(y.Ay,{item:!0,children:(0,B.jsx)(p.A,{component:n.N_,to:"/register",variant:"body2",children:"Don't have an account? Sign Up"})})]}),(0,B.jsx)(j.A,{sx:{mt:3,textAlign:"center"},children:(0,B.jsxs)(f.A,{variant:"caption",color:"text.secondary",children:["By signing in, you agree to our"," ",(0,B.jsx)(p.A,{component:n.N_,to:"/privacy",color:"primary",children:"Privacy Policy"})]})})]})]}),(0,B.jsxs)(v.A,{open:W.open,onClose:I,"aria-labelledby":"error-dialog-title",children:[(0,B.jsx)(b.A,{id:"error-dialog-title",children:"Login Failed"}),(0,B.jsx)(P.A,{children:(0,B.jsx)(C.A,{children:W.message})}),(0,B.jsxs)(T.A,{children:[W.showRegisterButton&&(0,B.jsx)(u.A,{onClick:()=>{r("/register")},color:"primary",variant:"contained",children:"Register"}),W.showForgotPasswordButton&&(0,B.jsx)(u.A,{onClick:()=>{r("/forgot-password")},color:"primary",variant:"contained",children:"Forgot Password"}),(0,B.jsx)(u.A,{onClick:I,color:"primary",autoFocus:!0,children:"Retry"})]})]})]})]})};var E=o(2555),F=o(45),W=o(5539),R=o(1673),I=o(7566);const Y=["confirmPassword","agreeToTerms"],N=d.Ik({name:d.Yj().required("Name is required"),email:d.Yj().email("Enter a valid email").required("Email is required"),password:d.Yj().min(6,"Password should be of minimum 6 characters length").required("Password is required"),confirmPassword:d.Yj().oneOf([d.KR("password"),void 0],"Passwords must match").required("Confirm Password is required"),agreeToTerms:d.zM().oneOf([!0],"You must agree to the privacy policy").required("Field is required")}),_=()=>{const e=(0,c.jL)(),r=(0,a.Zp)(),{isAuthenticated:o,loading:d,error:v}=(0,t.d4)(e=>e.auth);(0,s.useEffect)(()=>{o&&r("/dashboard")},[o,r]),(0,s.useEffect)(()=>{if(v){const o="string"===typeof v?v.toLowerCase():"";o.includes("already registered")||o.includes("already exists")?(e((0,W.S7)("info","You are already registered. Please login.")),r("/login")):e((0,W.S7)("error",v))}},[v,e,r]);const b=(0,l.Wx)({initialValues:{name:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1},validationSchema:N,onSubmit:r=>{const{confirmPassword:o,agreeToTerms:s}=r,a=(0,F.A)(r,Y);e((0,i.kz)((0,E.A)((0,E.A)({},a),{},{userType:"room_seeker"})))}});return(0,B.jsxs)(y.Ay,{container:!0,component:"main",sx:{height:"100vh"},children:[(0,B.jsx)(y.Ay,{item:!0,xs:!1,sm:4,md:7,sx:{backgroundImage:"url(https://picsum.photos/seed/apartment-register/1600/900)",backgroundRepeat:"no-repeat",backgroundColor:e=>"light"===e.palette.mode?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"}}),(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:8,md:5,component:A.A,elevation:6,square:!0,children:(0,B.jsxs)(j.A,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,B.jsx)(m.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,B.jsx)(I.A,{})}),(0,B.jsx)(f.A,{component:"h1",variant:"h5",children:"Sign up"}),(0,B.jsxs)(j.A,{component:"form",noValidate:!0,onSubmit:b.handleSubmit,sx:{mt:1,width:"100%"},children:[(0,B.jsxs)(y.Ay,{container:!0,spacing:2,children:[(0,B.jsx)(y.Ay,{item:!0,xs:12,children:(0,B.jsx)(h.A,{required:!0,fullWidth:!0,id:"name",label:"Full Name",name:"name",autoComplete:"name",value:b.values.name,onChange:b.handleChange,onBlur:b.handleBlur,error:b.touched.name&&Boolean(b.errors.name),helperText:b.touched.name&&b.errors.name})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,children:(0,B.jsx)(h.A,{required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:b.values.email,onChange:b.handleChange,onBlur:b.handleBlur,error:b.touched.email&&Boolean(b.errors.email),helperText:b.touched.email&&b.errors.email})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,children:(0,B.jsx)(h.A,{required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"new-password",value:b.values.password,onChange:b.handleChange,onBlur:b.handleBlur,error:b.touched.password&&Boolean(b.errors.password),helperText:b.touched.password&&b.errors.password})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,children:(0,B.jsx)(h.A,{required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",value:b.values.confirmPassword,onChange:b.handleChange,onBlur:b.handleBlur,error:b.touched.confirmPassword&&Boolean(b.errors.confirmPassword),helperText:b.touched.confirmPassword&&b.errors.confirmPassword})}),(0,B.jsxs)(y.Ay,{item:!0,xs:12,children:[(0,B.jsx)(x.A,{control:(0,B.jsx)(g.A,{name:"agreeToTerms",color:"primary",checked:b.values.agreeToTerms,onChange:b.handleChange,onBlur:b.handleBlur}),label:(0,B.jsxs)(f.A,{variant:"body2",children:["I agree to the"," ",(0,B.jsx)(p.A,{component:n.N_,to:"/privacy",target:"_blank",children:"Privacy Policy"})]})}),b.touched.agreeToTerms&&b.errors.agreeToTerms&&(0,B.jsx)(R.A,{error:!0,sx:{ml:2},children:b.errors.agreeToTerms})]})]}),(0,B.jsx)(u.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:d,children:d?(0,B.jsx)(w.A,{size:24}):"Sign Up"}),(0,B.jsx)(y.Ay,{container:!0,justifyContent:"flex-end",children:(0,B.jsx)(y.Ay,{item:!0,children:(0,B.jsx)(p.A,{component:n.N_,to:"/login",variant:"body2",children:"Already have an account? Sign in"})})})]})]})})]})};d.Ik({phone:d.Yj().matches(/^[0-9+\-\s]+$/,"Invalid phone number format").required("Phone number is required"),userType:d.Yj().required("Please select what you are looking for"),bio:d.Yj().max(500,"Bio should not exceed 500 characters")});var z=o(9252),D=o(4194),L=o(8606);const O=()=>{const e=(0,a.Zp)(),r=(0,t.wA)(),[o]=(0,n.ok)();(0,s.useEffect)(()=>{const s=o.get("token");if(o.get("error"))setTimeout(()=>{e("/login",{state:{error:"Authentication failed. Please try again."}})},3e3);else if(s)try{localStorage.setItem("token",s),r((0,i.WG)(s)),r((0,i.YW)()),setTimeout(()=>{e("/dashboard")},2e3)}catch(a){console.error("Error handling auth success:",a),setTimeout(()=>{e("/login",{state:{error:"Authentication data error. Please try again."}})},3e3)}else setTimeout(()=>{e("/login",{state:{error:"Authentication incomplete. Please try again."}})},3e3)},[o,r,e]);const l=o.get("error");return(0,B.jsx)(z.A,{maxWidth:"sm",sx:{mt:8},children:(0,B.jsx)(A.A,{elevation:3,sx:{p:4,textAlign:"center"},children:l?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(D.A,{severity:"error",sx:{mb:3},children:["Authentication failed: ",l]}),(0,B.jsx)(f.A,{variant:"body1",color:"text.secondary",children:"Redirecting to login page..."})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(j.A,{sx:{mb:3},children:(0,B.jsx)(L.A,{sx:{fontSize:64,color:"success.main",mb:2}})}),(0,B.jsx)(f.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Authentication Successful!"}),(0,B.jsx)(f.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Welcome to Flatmates! Setting up your account..."}),(0,B.jsx)(j.A,{sx:{display:"flex",justifyContent:"center"},children:(0,B.jsx)(w.A,{})}),(0,B.jsx)(f.A,{variant:"body2",color:"text.secondary",sx:{mt:2},children:"You will be redirected shortly."})]})})})}}}]);
//# sourceMappingURL=761.6e3c6907.chunk.js.map