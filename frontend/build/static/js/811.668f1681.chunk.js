"use strict";(self.webpackChunkflatmates_frontend=self.webpackChunkflatmates_frontend||[]).push([[811],{3036:(e,r,t)=>{t.d(r,{CreateProperty:()=>Te,EditProperty:()=>_e,MyListings:()=>De,PropertyDetails:()=>Ae,PropertyListing:()=>re});var s=t(5043),i=t(9252),n=t(6446),l=t(1637),a=t(4194),o=t(5865),d=t(7784),c=t(1787),x=t(3336),p=t(8903),h=t(7629),u=t(3193),m=t(9190),y=t(9285),A=t(1449),j=t(1828),v=t(4511),g=t(1906),f=t(2110),b=t(6591),C=t(3845),P=t(6494),S=t(5475),w=t(6360),T=t(7981),_=t(2536),B=t(9974),W=t(8468),D=t(4476),I=t(3639),z=t(3216),k=t(35),E=t(6600),L=t(5316),R=t(8533),F=t(9347),N=t(2807),O=t(7566),q=t(579);const U=e=>{let{open:r,onClose:t,title:s="Login Required",message:i="Please log in or register to view full property details and contact owners."}=e;const n=(0,z.Zp)();return(0,q.jsxs)(k.A,{open:r,onClose:t,"aria-labelledby":"auth-prompt-title","aria-describedby":"auth-prompt-description",children:[(0,q.jsx)(E.A,{id:"auth-prompt-title",children:s}),(0,q.jsx)(L.A,{children:(0,q.jsx)(R.A,{id:"auth-prompt-description",children:i})}),(0,q.jsxs)(F.A,{sx:{p:2,justifyContent:"center",gap:2},children:[(0,q.jsx)(g.A,{variant:"outlined",onClick:()=>{t(),n("/login")},startIcon:(0,q.jsx)(N.A,{}),fullWidth:!0,children:"Login"}),(0,q.jsx)(g.A,{variant:"contained",onClick:()=>{t(),n("/register")},startIcon:(0,q.jsx)(O.A,{}),fullWidth:!0,children:"Register"})]})]})};var H=t(9419),Y=t(2023),V=t(6036),G=t(3318),M=t(228),K=t.n(M),Z=(t(6433),t(8249)),J=t(7024),$=t(1071);delete K().Icon.Default.prototype._getIconUrl,K().Icon.Default.mergeOptions({iconRetinaUrl:Z,iconUrl:J,shadowUrl:$});const Q=e=>{var r,t;let{properties:s,onViewDetails:i}=e;const l=s.length>0&&null!==(r=s[0].address)&&void 0!==r&&r.coordinates?[s[0].address.coordinates.lat,s[0].address.coordinates.lng]:[20.5937,78.9629],a=s.length>0&&null!==(t=s[0].address)&&void 0!==t&&t.coordinates?12:5;return(0,q.jsx)(n.A,{sx:{height:"600px",width:"100%",borderRadius:2,overflow:"hidden",border:"1px solid #ddd"},children:(0,q.jsxs)(H.W,{center:l,zoom:a,style:{height:"100%",width:"100%"},children:[(0,q.jsx)(Y.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s.map(e=>{var r,t;return null!==(r=e.address)&&void 0!==r&&r.coordinates?(0,q.jsx)(V.p,{position:[e.address.coordinates.lat,e.address.coordinates.lng],children:(0,q.jsx)(G.z,{children:(0,q.jsxs)(n.A,{sx:{p:1,maxWidth:200},children:[(0,q.jsx)(o.A,{variant:"subtitle2",fontWeight:"bold",children:e.title}),(0,q.jsxs)(o.A,{variant:"body2",color:"primary",fontWeight:"bold",sx:{mb:1},children:["\u20b9",(null===(t=e.price)||void 0===t?void 0:t.amount)||0,"/month"]}),(0,q.jsx)(g.A,{variant:"contained",size:"small",fullWidth:!0,onClick:()=>i(e._id),children:"View Details"})]})})},e._id):null})]})})};var X=t(8202),ee=t(7462);const re=()=>{const e=(0,X.jL)(),{properties:r,loading:t,error:k}=(0,X.GV)(e=>e.property),[E,L]=(0,s.useState)(""),[R,F]=(0,s.useState)(""),[N,O]=(0,s.useState)([0,1e5]),[H,Y]=(0,s.useState)("all"),[V,G]=(0,s.useState)("all"),[M,K]=(0,s.useState)([]),[Z,J]=(0,s.useState)("list"),[$,re]=(0,s.useState)(!1),{isAuthenticated:te}=(0,X.GV)(e=>e.auth),se=(0,z.Zp)();(0,s.useEffect)(()=>{const e=setTimeout(()=>{F(E)},500);return()=>clearTimeout(e)},[E]),(0,s.useEffect)(()=>{const r={};R&&(r.search=R),"all"!==H&&(r.propertyType=H),"all"!==V&&(r.listingType=V),r.minPrice=N[0],r.maxPrice=N[1],e((0,ee.oY)(r))},[e,R,N,H,V]),(0,s.useEffect)(()=>{r&&K(r)},[r]);const ie=e=>{te?se("/properties/".concat(e)):re(!0)};return t?(0,q.jsx)(i.A,{maxWidth:"lg",sx:{py:4},children:(0,q.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,q.jsx)(l.A,{})})}):k?(0,q.jsx)(i.A,{maxWidth:"lg",sx:{py:4},children:(0,q.jsx)(a.A,{severity:"error",children:"string"===typeof k?k:k.msg||"An error occurred"})}):(0,q.jsxs)(i.A,{maxWidth:"lg",sx:{py:4},children:[(0,q.jsxs)(n.A,{sx:{mb:4},children:[(0,q.jsx)(o.A,{variant:"h3",component:"h1",gutterBottom:!0,children:"Property Listings"}),(0,q.jsx)(o.A,{variant:"subtitle1",color:"text.secondary",paragraph:!0,children:"Find your perfect flatmate or room"}),(0,q.jsx)(d.A,{fullWidth:!0,variant:"outlined",label:"Search Properties",placeholder:"Search properties by title, location, or description...",value:E,onChange:e=>{L(e.target.value)},InputProps:{startAdornment:(0,q.jsx)(c.A,{position:"start",children:(0,q.jsx)(w.A,{"aria-hidden":"true"})})},sx:{mb:3}}),(0,q.jsx)(x.A,{elevation:2,sx:{p:2,mb:3,borderRadius:2},children:(0,q.jsxs)(p.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,q.jsxs)(p.Ay,{item:!0,xs:12,md:3,children:[(0,q.jsxs)(o.A,{variant:"caption",color:"text.secondary",gutterBottom:!0,display:"block",children:["Budget Range: \u20b9",N[0]," - \u20b9",N[1],"+"]}),(0,q.jsx)(h.Ay,{value:N,onChange:(e,r)=>{O(r)},valueLabelDisplay:"auto",min:0,max:1e5,step:1e3,size:"small"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,q.jsxs)(u.A,{fullWidth:!0,size:"small",children:[(0,q.jsx)(m.A,{children:"Property Type"}),(0,q.jsxs)(y.A,{value:H,label:"Property Type",onChange:e=>{Y(e.target.value)},children:[(0,q.jsx)(A.A,{value:"all",children:"All Types"}),(0,q.jsx)(A.A,{value:"apartment",children:"Apartment"}),(0,q.jsx)(A.A,{value:"house",children:"House"}),(0,q.jsx)(A.A,{value:"pg",children:"PG/Hostel"})]})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,q.jsxs)(u.A,{fullWidth:!0,size:"small",children:[(0,q.jsx)(m.A,{children:"Listing Type"}),(0,q.jsxs)(y.A,{value:V,label:"Listing Type",onChange:e=>{G(e.target.value)},children:[(0,q.jsx)(A.A,{value:"all",children:"All Listings"}),(0,q.jsx)(A.A,{value:"room_seeker",children:"Find Flatmate"}),(0,q.jsx)(A.A,{value:"property_owner",children:"Full Property"})]})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,md:3,sx:{display:"flex",justifyContent:"flex-end"},children:(0,q.jsxs)(j.A,{value:Z,exclusive:!0,onChange:(e,r)=>{null!==r&&J(r)},"aria-label":"view mode",size:"small",children:[(0,q.jsxs)(v.A,{value:"list","aria-label":"list view",children:[(0,q.jsx)(T.A,{sx:{mr:1}})," List"]}),(0,q.jsxs)(v.A,{value:"map","aria-label":"map view",children:[(0,q.jsx)(_.A,{sx:{mr:1}})," Map"]})]})})]})})]}),0===M.length?(0,q.jsxs)(n.A,{textAlign:"center",py:8,children:[(0,q.jsx)(I.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,q.jsx)(o.A,{variant:"h5",component:"h2",gutterBottom:!0,children:"No properties found"}),(0,q.jsx)(o.A,{variant:"body1",color:"text.secondary",paragraph:!0,children:E?"Try adjusting your search terms.":"Be the first to list a property!"}),(0,q.jsx)(g.A,{variant:"contained",component:S.N_,to:"/properties/create",size:"large",children:"List Your Property"})]}):"list"===Z?(0,q.jsx)(p.Ay,{container:!0,spacing:3,children:M.map(e=>{var r,t,s,i,l,a;return(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,q.jsxs)(f.A,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:[(0,q.jsxs)(n.A,{sx:{position:"relative"},children:[(0,q.jsx)(b.A,{component:"img",height:"200",image:null!==(r=e.images)&&void 0!==r&&null!==(t=r[0])&&void 0!==t&&t.url?e.images[0].url.startsWith("http")?e.images[0].url:"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"").concat(e.images[0].url):"https://picsum.photos/seed/no-image-listing/300/200",alt:"Property: ".concat(e.title," in ").concat((null===(s=e.address)||void 0===s?void 0:s.city)||"India"),loading:"lazy"}),e.propertyVerified&&(0,q.jsx)(C.A,{icon:(0,q.jsx)(D.A,{sx:{fontSize:"14px !important"}}),label:"Verified Property",size:"small",color:"success",sx:{position:"absolute",top:10,left:10,height:24,fontSize:"10px",fontWeight:"bold",bgcolor:"success.main",color:"white"}}),e.isVerified&&(0,q.jsx)(C.A,{icon:(0,q.jsx)(W.A,{sx:{fontSize:"14px !important"}}),label:"Verified Owner",size:"small",color:"info",sx:{position:"absolute",top:10,right:10,height:24,fontSize:"10px",fontWeight:"bold",bgcolor:"info.main",color:"white"}})]}),(0,q.jsxs)(P.A,{sx:{flexGrow:1},children:[(0,q.jsx)(o.A,{gutterBottom:!0,variant:"h6",component:"h3",children:e.title}),(0,q.jsxs)(n.A,{display:"flex",alignItems:"center",mb:1,children:[(0,q.jsx)(B.A,{sx:{fontSize:16,mr:.5,color:"text.secondary"}}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"string"===typeof e.address?e.address:e.address?"".concat(e.address.street||"",", ").concat(e.address.city||"",", ").concat(e.address.state||""):""})]}),(0,q.jsxs)(n.A,{display:"flex",alignItems:"center",mb:2,children:[(0,q.jsx)(o.A,{variant:"h6",color:"primary",sx:{fontWeight:"bold",mr:.5},children:"\u20b9"}),(0,q.jsxs)(o.A,{variant:"h6",color:"primary",children:[(null===(i=e.price)||void 0===i?void 0:i.amount)||0,"/month"]})]}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",paragraph:!0,children:e.description?"".concat(e.description.substring(0,100),"..."):"No description available"}),(0,q.jsxs)(n.A,{display:"flex",flexWrap:"wrap",gap:.5,mb:2,children:[(0,q.jsx)(C.A,{label:"".concat((null===(l=e.features)||void 0===l?void 0:l.bedrooms)||e.bedrooms||0," bed"),size:"small"}),(0,q.jsx)(C.A,{label:"".concat((null===(a=e.features)||void 0===a?void 0:a.bathrooms)||e.bathrooms||0," bath"),size:"small"}),(0,q.jsx)(C.A,{label:e.propertyType||"N/A",size:"small"})]})]}),(0,q.jsx)(n.A,{sx:{p:2,pt:0},children:(0,q.jsx)(g.A,{fullWidth:!0,variant:"contained",onClick:()=>ie(e._id),children:"View Details"})})]})},e._id)})}):(0,q.jsx)(Q,{properties:M,onViewDetails:ie}),(0,q.jsx)(U,{open:$,onClose:()=>re(!1)})]})};var te=t(9456),se=t(7392),ie=t(9336),ne=t(1045),le=t(7600),ae=t(7332),oe=t(8994),de=t(5244),ce=t(7466),xe=t(3817),pe=t(3560),he=t(3768),ue=t(889),me=t(5539),ye=t(4021);const Ae=()=>{var e,r,t,i,a,c,h,u,m,y,A,j,v,b,S;const{id:w}=(0,z.g)(),T=(0,te.wA)(),_=(0,z.Zp)(),{property:B,loading:W,savedProperties:D}=(0,te.d4)(e=>e.property),{user:I,isAuthenticated:N}=(0,te.d4)(e=>e.auth),[O,U]=(0,s.useState)(0),[H,Y]=(0,s.useState)(!1),[V,G]=(0,s.useState)(!1);(0,s.useEffect)(()=>{w&&T((0,ee.qz)(w))},[T,w]),(0,s.useEffect)(()=>{if(B&&D){D.some(e=>e._id===B._id);B.isSaved}},[B,D]);const M=()=>{G(!1)},K=I&&B&&I._id===B.owner._id;return W?(0,q.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,q.jsx)(l.A,{})}):B?(0,q.jsxs)(n.A,{sx:{maxWidth:1200,mx:"auto",p:3},children:[(0,q.jsx)("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"RealEstateListing",name:B.title,description:B.description,url:window.location.href,image:null===(e=B.images)||void 0===e||null===(r=e[0])||void 0===r?void 0:r.url,address:{"@type":"PostalAddress",streetAddress:B.address.street,addressLocality:B.address.city,addressRegion:B.address.state,postalCode:B.address.zipCode,addressCountry:"IN"}})}),(0,q.jsxs)(n.A,{sx:{position:"relative",mb:4},children:[B.images&&B.images.length>0?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(n.A,{component:"img",src:null!==(t=B.images[O])&&void 0!==t&&t.url?B.images[O].url.startsWith("http")?B.images[O].url:"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"").concat(B.images[O].url):B.images[O],alt:"View of ".concat(B.title),loading:"lazy",sx:{width:"100%",height:400,objectFit:"cover",borderRadius:2}}),B.images.length>1&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(se.A,{onClick:()=>{B&&B.images.length>0&&U(e=>(e-1+B.images.length)%B.images.length)},sx:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:(0,q.jsx)(ae.A,{})}),(0,q.jsx)(se.A,{onClick:()=>{B&&B.images.length>0&&U(e=>(e+1)%B.images.length)},sx:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:(0,q.jsx)(oe.A,{})})]})]}):(0,q.jsx)(n.A,{sx:{width:"100%",height:400,bgcolor:"grey.200",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:2},children:(0,q.jsx)(o.A,{variant:"h6",color:"text.secondary",children:"No Image Available"})}),(0,q.jsxs)(n.A,{sx:{position:"absolute",top:16,right:16,display:"flex",gap:1},children:[(0,q.jsx)(se.A,{onClick:async()=>{if(N){if(B)try{await T((0,ee.Jy)(B._id)).unwrap(),T((0,me.S7)("success",B.isSaved?"Property removed from saved":"Property saved successfully"))}catch(e){T((0,me.S7)("error",e.message||"Failed to save property"))}}else T((0,me.S7)("error","Please log in to save properties"))},sx:{bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:B.isSaved?(0,q.jsx)(de.A,{color:"error"}):(0,q.jsx)(ce.A,{})}),(0,q.jsx)(se.A,{onClick:()=>{G(!0)},sx:{bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:(0,q.jsx)(xe.A,{})}),K&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(se.A,{onClick:()=>{B&&_("/properties/edit/".concat(B._id))},sx:{bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:(0,q.jsx)(pe.A,{})}),(0,q.jsx)(se.A,{onClick:async()=>{if(window.confirm("Are you sure you want to delete this property?"))try{await T((0,ee.BJ)(B._id)).unwrap(),T((0,me.S7)("success","Property deleted successfully")),_("/properties")}catch(e){T((0,me.S7)("error",e.message||"Failed to delete property"))}},sx:{bgcolor:"rgba(255, 255, 255, 0.8)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},children:(0,q.jsx)(he.A,{})})]})]})]}),(0,q.jsxs)(n.A,{sx:{mb:4},children:[(0,q.jsx)(o.A,{variant:"h4",gutterBottom:!0,children:B.title}),(0,q.jsxs)(o.A,{variant:"h5",color:"primary",gutterBottom:!0,children:["\u20b9",null!==(i=null===B||void 0===B||null===(a=B.price)||void 0===a||null===(c=a.amount)||void 0===c||null===(h=c.toLocaleString)||void 0===h?void 0:h.call(c))&&void 0!==i?i:"N/A","/month"]}),(0,q.jsxs)(o.A,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:[B.address.street,", ",B.address.city,","," ",B.address.state," ",B.address.zipCode]}),(0,q.jsxs)(n.A,{sx:{display:"flex",gap:3,mt:2},children:[(0,q.jsx)(C.A,{label:"".concat((null===(u=B.features)||void 0===u?void 0:u.bedrooms)||0," Bed").concat(1!==(null===(m=B.features)||void 0===m?void 0:m.bedrooms)?"s":""),color:"primary",variant:"outlined"}),(0,q.jsx)(C.A,{label:"".concat((null===(y=B.features)||void 0===y?void 0:y.bathrooms)||0," Bath").concat(1!==(null===(A=B.features)||void 0===A?void 0:A.bathrooms)?"s":""),color:"primary",variant:"outlined"}),(0,q.jsx)(C.A,{label:"".concat(null!==(j=B.features)&&void 0!==j&&j.area?B.features.area.toLocaleString():"N/A"," sq ft"),color:"primary",variant:"outlined"}),(0,q.jsx)(C.A,{label:"Available: ".concat(null!==(v=B.availability)&&void 0!==v&&v.availableFrom?new Date(B.availability.availableFrom).toLocaleDateString():"N/A"),color:"primary",variant:"outlined"}),(0,q.jsx)(C.A,{label:B.propertyType?B.propertyType.charAt(0).toUpperCase()+B.propertyType.slice(1):"N/A",color:"primary",variant:"outlined"}),(0,q.jsx)(C.A,{label:B.userType?B.userType.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"N/A",color:"primary",variant:"outlined"})]})]}),(0,q.jsxs)(p.Ay,{container:!0,spacing:4,children:[(0,q.jsx)(p.Ay,{item:!0,xs:12,md:8,children:(0,q.jsxs)(x.A,{elevation:2,sx:{p:3,mb:4},children:[(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Description"}),(0,q.jsx)(o.A,{variant:"body1",paragraph:!0,children:B.description}),(null===(b=B.features)||void 0===b?void 0:b.amenities)&&B.features.amenities.length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(ie.A,{sx:{my:3}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Amenities"}),(0,q.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:B.features.amenities.map((e,r)=>(0,q.jsx)(C.A,{label:e,variant:"outlined"},r))})]}),B.preferences&&Object.keys(B.preferences).length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(ie.A,{sx:{my:3}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Preferences"}),(0,q.jsxs)(p.Ay,{container:!0,spacing:2,children:[B.preferences.gender&&(0,q.jsxs)(p.Ay,{item:!0,xs:12,sm:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Gender Preference:"}),(0,q.jsx)(o.A,{variant:"body1",children:B.preferences.gender})]}),B.preferences.occupation&&(0,q.jsxs)(p.Ay,{item:!0,xs:12,sm:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Occupation Preference:"}),(0,q.jsx)(o.A,{variant:"body1",children:B.preferences.occupation})]}),B.preferences.lifestyle&&(0,q.jsxs)(p.Ay,{item:!0,xs:12,sm:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Lifestyle Preference:"}),(0,q.jsx)(o.A,{variant:"body1",children:B.preferences.lifestyle})]}),B.preferences.ageRange&&(0,q.jsxs)(p.Ay,{item:!0,xs:12,sm:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Age Range Preference:"}),(0,q.jsx)(o.A,{variant:"body1",children:B.preferences.ageRange})]})]})]}),B.rules&&B.rules.length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(ie.A,{sx:{my:3}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"House Rules"}),(0,q.jsx)("ul",{children:B.rules.map((e,r)=>(0,q.jsx)("li",{children:(0,q.jsx)(o.A,{variant:"body1",children:e})},r))})]})]})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,md:4,children:[(0,q.jsxs)(f.A,{elevation:2,sx:{mb:4},children:[(0,q.jsxs)(P.A,{children:[(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Listed by"}),(0,q.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,q.jsx)(ne.A,{src:B.owner.avatar,alt:"Profile picture of owner ".concat(B.owner.name),sx:{width:56,height:56,mr:2}}),(0,q.jsxs)(n.A,{children:[(0,q.jsx)(o.A,{variant:"subtitle1",children:B.owner.name}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:null!==(S=B.owner)&&void 0!==S&&S.userType?B.owner.userType.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"User"})]})]}),(0,q.jsxs)(o.A,{variant:"body2",color:"text.secondary",paragraph:!0,children:["Member since"," ",new Date(B.owner.createdAt).toLocaleDateString()]})]}),(0,q.jsx)(le.A,{children:!K&&(0,q.jsx)(g.A,{fullWidth:!0,variant:"contained",startIcon:(0,q.jsx)(ue.A,{}),onClick:()=>{N?Y(!0):T((0,me.S7)("error","Please log in to contact the owner"))},children:"Contact Owner"})})]}),(0,q.jsxs)(x.A,{elevation:2,sx:{p:3},children:[(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Property Details"}),(0,q.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,q.jsxs)(p.Ay,{item:!0,xs:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Property ID:"}),(0,q.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[B._id.substring(0,8),"..."]})]}),(0,q.jsxs)(p.Ay,{item:!0,xs:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Property Type:"}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:B.propertyType?B.propertyType.charAt(0).toUpperCase()+B.propertyType.slice(1):"N/A"})]}),(0,q.jsxs)(p.Ay,{item:!0,xs:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Listed On:"}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:new Date(B.createdAt).toLocaleDateString()})]}),(0,q.jsxs)(p.Ay,{item:!0,xs:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Last Updated:"}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:new Date(B.updatedAt).toLocaleDateString()})]}),(0,q.jsxs)(p.Ay,{item:!0,xs:6,children:[(0,q.jsx)(o.A,{variant:"subtitle2",children:"Views:"}),(0,q.jsx)(o.A,{variant:"body2",color:"text.secondary",children:B.views})]})]})]})]})]}),(0,q.jsx)(ye.A,{open:H,onClose:()=>{Y(!1)},propertyId:B._id,ownerId:B.owner._id}),(0,q.jsxs)(k.A,{open:V,onClose:M,children:[(0,q.jsx)(E.A,{children:"Share this property"}),(0,q.jsxs)(L.A,{children:[(0,q.jsx)(R.A,{children:"Copy the link below to share this property with others."}),(0,q.jsx)(d.A,{margin:"dense",fullWidth:!0,value:window.location.href,variant:"outlined",InputProps:{readOnly:!0}})]}),(0,q.jsxs)(F.A,{children:[(0,q.jsx)(g.A,{onClick:M,children:"Cancel"}),(0,q.jsx)(g.A,{onClick:()=>{navigator.clipboard.writeText(window.location.href),T((0,me.S7)("success","Link copied to clipboard")),M()},variant:"contained",children:"Copy Link"})]})]})]}):(0,q.jsx)(n.A,{sx:{p:3},children:(0,q.jsx)(o.A,{variant:"h6",children:"Property not found"})})};var je=t(3516),ve=t(899),ge=t(1673),fe=t(8446),be=t(490),Ce=t(2505),Pe=t(3471),Se=t(2954);const we=()=>{const{id:e}=(0,z.g)(),r=(0,z.Zp)(),t=(0,X.jL)(),{property:i,loading:h}=(0,te.d4)(e=>e.property),[j,v]=(0,s.useState)([]),[P,w]=(0,s.useState)([]),[T,_]=(0,s.useState)([]),[B,W]=(0,s.useState)(!1),[D,I]=(0,s.useState)([]),k=Boolean(e);(0,s.useEffect)(()=>{k&&e&&t((0,ee.qz)(e))},[t,e,k]),(0,s.useEffect)(()=>{k&&i&&i.images&&w(i.images)},[k,i]);const E=e=>{e.preventDefault();const r=e.target.files,s=r?Array.from(r):[];if(0===s.length)return;const i=s.filter(e=>{const r=["image/jpeg","image/png","image/jpg"].includes(e.type),s=e.size<=5242880;return r||t((0,me.S7)("error","Only JPEG, JPG and PNG images are allowed")),s||t((0,me.S7)("error","Image size should not exceed 5MB")),r&&s});if(0===i.length)return;[...j,...i].length>5?t((0,me.S7)("warning","Maximum 5 images allowed")):(v([...j,...i]),i.forEach(e=>{const r=new FileReader;r.onloadend=()=>{w(e=>[...e,r.result||""])},r.readAsDataURL(e)}))},L=ve.Ik({title:ve.Yj().required("Title is required").max(100,"Title must be at most 100 characters"),description:ve.Yj().required("Description is required").min(20,"Description must be at least 20 characters"),propertyType:ve.Yj().required("Property type is required"),listingType:ve.Yj().required("Listing type is required"),price:ve.Ik({amount:ve.ai().required("Price is required").positive("Price must be positive"),brokerage:ve.ai().min(0,"Brokerage cannot be negative")}),address:ve.Ik({street:ve.Yj(),city:ve.Yj().required("City is required"),state:ve.Yj(),zipCode:ve.Yj().required("Zip Code is required").matches(/^[0-9]{6}$/,"Zip Code must be exactly 6 digits"),country:ve.Yj().required("Country is required")}),bedrooms:ve.ai().min(0,"Cannot be negative").nullable(),bathrooms:ve.ai().min(0,"Cannot be negative").nullable(),size:ve.ai().min(0,"Cannot be negative").nullable(),availableFrom:ve.p6().required("Available from date is required").nullable()});return k&&h?(0,q.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,q.jsx)(l.A,{})}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(n.A,{sx:{mb:4},children:[(0,q.jsx)(o.A,{variant:"h4",component:"h1",gutterBottom:!0,children:k?"Edit Property":"Create New Property"}),(0,q.jsx)(o.A,{variant:"body1",color:"text.secondary",children:k?"Update your property listing with accurate and detailed information.":"Fill in the details below to create your property listing."})]}),(0,q.jsx)(x.A,{elevation:2,sx:{p:3},children:(0,q.jsx)(je.l1,{initialValues:(()=>{if(k&&i){var e,r,t,s,n,l,a,o,d,c,x,p,h,u,m,y,A,j;const v=i;return{title:v.title||"",description:v.description||"",propertyType:v.propertyType||"",listingType:v.listingType||"",price:{amount:v.price&&(null!==(e=null!==(r=v.price.amount)&&void 0!==r?r:v.price.min)&&void 0!==e?e:0)||0,brokerage:null!==(t=null===(s=v.price)||void 0===s?void 0:s.brokerage)&&void 0!==t?t:0},address:{street:(null===(n=v.address)||void 0===n?void 0:n.street)||"",city:(null===(l=v.address)||void 0===l?void 0:l.city)||"",state:(null===(a=v.address)||void 0===a?void 0:a.state)||"",zipCode:(null===(o=v.address)||void 0===o?void 0:o.zipCode)||"",country:(null===(d=v.address)||void 0===d?void 0:d.country)||""},bedrooms:null!=(null===(c=v.features)||void 0===c?void 0:c.bedrooms)?String(v.features.bedrooms):"",bathrooms:null!=(null===(x=v.features)||void 0===x?void 0:x.bathrooms)?String(v.features.bathrooms):"",size:null!=(null===(p=v.features)||void 0===p?void 0:p.area)?String(v.features.area):"",availableFrom:null!==(h=v.availability)&&void 0!==h&&h.availableFrom?new Date(v.availability.availableFrom).toISOString().split("T")[0]:"",amenities:(null===(u=v.features)||void 0===u?void 0:u.amenities)||[],rules:v.rules||[],preferences:{gender:(null===(m=v.preferences)||void 0===m?void 0:m.gender)||"",occupation:(null===(y=v.preferences)||void 0===y?void 0:y.occupation)||"",lifestyle:(null===(A=v.preferences)||void 0===A?void 0:A.lifestyle)||"",ageRange:(null===(j=v.preferences)||void 0===j?void 0:j.ageRange)||""}}}return{title:"",description:"",propertyType:"",listingType:"",price:{amount:0,brokerage:0},address:{street:"",city:"",state:"",zipCode:"",country:"India"},bedrooms:"",bathrooms:"",size:"",availableFrom:"",amenities:[],rules:[],preferences:{gender:"",occupation:"",lifestyle:"",ageRange:""}}})(),validationSchema:L,onSubmit:async(s,i)=>{let{setSubmitting:n}=i;W(!0),I([]);try{const i=[];if(k||0!==j.length||i.push("At least one property image is required"),k&&0===j.length&&0===P.length&&i.push("At least one property image is required"),i.length>0)return I(i),t((0,me.S7)("error","Please fix the errors before submitting")),W(!1),n(!1),void window.scrollTo({top:0,behavior:"smooth"});const l=s.listingType,a={title:s.title,description:s.description,propertyType:s.propertyType,listingType:l,address:{street:s.address.street||"",city:s.address.city,state:s.address.state||"",zipCode:s.address.zipCode||"",country:s.address.country},price:{amount:Number(s.price.amount),brokerage:Number(s.price.brokerage)||0},availability:{availableFrom:s.availableFrom},features:{bedrooms:Number(s.bedrooms)||0,bathrooms:Number(s.bathrooms)||0,area:Number(s.size)||0,amenities:s.amenities},preferences:s.preferences||{},images:j,removeImages:T};let o;o=k&&e?await t((0,ee.$x)({id:e,propertyData:a})):await t((0,ee.IL)(a)),o.payload&&(t((0,me.S7)("success",k?"Property updated successfully":"Property created successfully")),k||await t((0,ee.oY)({})).unwrap(),r(k?"/properties/".concat(e):"/properties"))}catch(l){console.error("Error submitting form:",l),t((0,me.S7)("error","Error: ".concat((null===l||void 0===l?void 0:l.message)||"Something went wrong")))}finally{W(!1),n(!1)}},enableReinitialize:!0,children:e=>{var t,s,x,h,W,z,L,R,F,N,O,U,H,Y,V,G,M,K,Z,J,$,Q,X,ee,re,te,ne,ae;let{values:oe,errors:de,touched:ce,handleChange:xe,handleBlur:pe,setFieldValue:he}=e;return(0,q.jsx)(je.lV,{children:(0,q.jsxs)(p.Ay,{container:!0,spacing:3,children:[D.length>0&&(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsxs)(a.A,{severity:"error",onClose:()=>I([]),children:[(0,q.jsx)(be.A,{children:"Please fix the following errors:"}),(0,q.jsx)("ul",{style:{margin:0,paddingLeft:20},children:D.map((e,r)=>(0,q.jsx)("li",{children:e},r))})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Basic Information"})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Title",name:"title",value:oe.title,onChange:xe,onBlur:pe,error:ce.title&&Boolean(de.title),helperText:ce.title&&de.title})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Description",name:"description",multiline:!0,rows:4,value:oe.description,onChange:xe,onBlur:pe,error:ce.description&&Boolean(de.description),helperText:ce.description&&de.description})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,error:ce.propertyType&&Boolean(de.propertyType),children:[(0,q.jsx)(m.A,{children:"Property Type"}),(0,q.jsxs)(je.D0,{as:y.A,name:"propertyType",label:"Property Type",value:oe.propertyType,onChange:xe,onBlur:pe,children:[(0,q.jsx)(A.A,{value:"apartment",children:"Apartment"}),(0,q.jsx)(A.A,{value:"house",children:"House"}),(0,q.jsx)(A.A,{value:"studio",children:"Studio"}),(0,q.jsx)(A.A,{value:"room",children:"Room"})]}),ce.propertyType&&de.propertyType&&(0,q.jsx)(ge.A,{children:de.propertyType})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,error:ce.listingType&&Boolean(de.listingType),children:[(0,q.jsx)(m.A,{children:"Listing Type"}),(0,q.jsxs)(je.D0,{as:y.A,name:"listingType",label:"Listing Type",value:oe.listingType,onChange:xe,onBlur:pe,children:[(0,q.jsx)(A.A,{value:"",children:(0,q.jsx)("em",{children:"Select Listing Type"})}),(0,q.jsx)(A.A,{value:"room_in_flat",children:"Room in a shared flat"}),(0,q.jsx)(A.A,{value:"roommates_for_flat",children:"Roommates for a flat"}),(0,q.jsx)(A.A,{value:"entire_property",children:"Entire Property"}),(0,q.jsx)(A.A,{value:"occupied_flat",children:"Occupied Flat"})]}),ce.listingType&&de.listingType&&(0,q.jsx)(ge.A,{children:de.listingType})]})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Price Information"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Price Amount",name:"price.amount",type:"number",value:oe.price.amount,onChange:xe,onBlur:pe,error:(null===(t=ce.price)||void 0===t?void 0:t.amount)&&Boolean(null===(s=de.price)||void 0===s?void 0:s.amount),helperText:(null===(x=ce.price)||void 0===x?void 0:x.amount)&&(null===(h=de.price)||void 0===h?void 0:h.amount),InputProps:{startAdornment:(0,q.jsx)(c.A,{position:"start",children:"\u20b9"})}})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Brokerage (if any)",name:"price.brokerage",type:"number",value:oe.price.brokerage,onChange:xe,onBlur:pe,error:(null===(W=ce.price)||void 0===W?void 0:W.brokerage)&&Boolean(null===(z=de.price)||void 0===z?void 0:z.brokerage),helperText:(null===(L=ce.price)||void 0===L?void 0:L.brokerage)&&(null===(R=de.price)||void 0===R?void 0:R.brokerage),InputProps:{startAdornment:(0,q.jsx)(c.A,{position:"start",children:"\u20b9"})}})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Address Information"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Street Address",name:"address.street",value:oe.address.street,onChange:xe,onBlur:pe,error:(null===(F=ce.address)||void 0===F?void 0:F.street)&&Boolean(null===(N=de.address)||void 0===N?void 0:N.street),helperText:(null===(O=ce.address)||void 0===O?void 0:O.street)&&(null===(U=de.address)||void 0===U?void 0:U.street)})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"ZIP/Postal Code",name:"address.zipCode",value:oe.address.zipCode,onChange:e=>{xe(e);const r=e.target.value;6===r.length&&fetch("https://api.postalpincode.in/pincode/".concat(r)).then(e=>e.json()).then(e=>{if("Success"===e[0].Status){const r=e[0].PostOffice[0];he("address.city",r.District),he("address.state",r.State),he("address.country","India")}}).catch(e=>console.error("Failed to fetch pincode details",e))},onBlur:pe,error:(null===(H=ce.address)||void 0===H?void 0:H.zipCode)&&Boolean(null===(Y=de.address)||void 0===Y?void 0:Y.zipCode),helperText:(null===(V=ce.address)||void 0===V?void 0:V.zipCode)&&(null===(G=de.address)||void 0===G?void 0:G.zipCode)})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"City",name:"address.city",value:oe.address.city,onChange:xe,onBlur:pe,error:(null===(M=ce.address)||void 0===M?void 0:M.city)&&Boolean(null===(K=de.address)||void 0===K?void 0:K.city),helperText:(null===(Z=ce.address)||void 0===Z?void 0:Z.city)&&(null===(J=de.address)||void 0===J?void 0:J.city),InputProps:{readOnly:!1}})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"State/Province",name:"address.state",value:oe.address.state,onChange:xe,onBlur:pe,error:(null===($=ce.address)||void 0===$?void 0:$.state)&&Boolean(null===(Q=de.address)||void 0===Q?void 0:Q.state),helperText:(null===(X=ce.address)||void 0===X?void 0:X.state)&&(null===(ee=de.address)||void 0===ee?void 0:ee.state)})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Country",name:"address.country",value:oe.address.country,onChange:xe,onBlur:pe,disabled:!0,error:(null===(re=ce.address)||void 0===re?void 0:re.country)&&Boolean(null===(te=de.address)||void 0===te?void 0:te.country),helperText:(null===(ne=ce.address)||void 0===ne?void 0:ne.country)&&(null===(ae=de.address)||void 0===ae?void 0:ae.country)})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Property Details"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Bedrooms",name:"bedrooms",type:"number",value:oe.bedrooms,onChange:xe,onBlur:pe,error:ce.bedrooms&&Boolean(de.bedrooms),helperText:ce.bedrooms&&de.bedrooms})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Bathrooms",name:"bathrooms",type:"number",value:oe.bathrooms,onChange:xe,onBlur:pe,error:ce.bathrooms&&Boolean(de.bathrooms),helperText:ce.bathrooms&&de.bathrooms})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Size (sq ft)",name:"size",type:"number",value:oe.size,onChange:xe,onBlur:pe,error:ce.size&&Boolean(de.size),helperText:ce.size&&de.size})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Available From",name:"availableFrom",type:"date",value:oe.availableFrom,onChange:xe,onBlur:pe,error:ce.availableFrom&&Boolean(de.availableFrom),helperText:ce.availableFrom&&de.availableFrom,InputLabelProps:{shrink:!0}})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Amenities"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(je.ED,{name:"amenities",children:e=>{let{push:r,remove:t}=e;return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:oe.amenities.map((e,r)=>(0,q.jsx)(C.A,{label:e,onDelete:()=>t(r),color:"primary",variant:"outlined"},r))}),(0,q.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,q.jsx)(je.D0,{as:d.A,name:"newAmenity",label:"Add Amenity",placeholder:"e.g. WiFi, Parking, Gym",fullWidth:!0,onKeyPress:e=>{if("Enter"===e.key){e.preventDefault();const t=e.target;t.value.trim()&&(r(t.value.trim()),t.value="")}}}),(0,q.jsx)(g.A,{variant:"outlined",onClick:()=>{const e=document.querySelector('input[name="newAmenity"]');e&&e instanceof HTMLInputElement&&e.value.trim()&&(r(e.value.trim()),e.value="")},children:"Add"})]})]})}})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"House Rules"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsx)(je.ED,{name:"rules",children:e=>{let{push:r,remove:t}=e;return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(n.A,{sx:{mb:2},children:oe.rules.map((e,r)=>(0,q.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,q.jsxs)(o.A,{variant:"body1",sx:{flexGrow:1},children:[r+1,". ",e]}),(0,q.jsx)(se.A,{size:"small",onClick:()=>t(r),color:"error",children:(0,q.jsx)(Pe.A,{})})]},r))}),(0,q.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,q.jsx)(je.D0,{as:d.A,name:"newRule",label:"Add House Rule",placeholder:"e.g. No smoking, No pets",fullWidth:!0,onKeyPress:e=>{if("Enter"===e.key){e.preventDefault();const t=e.target;t.value.trim()&&(r(t.value.trim()),t.value="")}}}),(0,q.jsx)(g.A,{variant:"outlined",onClick:()=>{const e=document.querySelector('input[name="newRule"]');e&&e instanceof HTMLInputElement&&e.value.trim()&&(r(e.value.trim()),e.value="")},children:"Add"})]})]})}})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Preferences (Optional)"})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,children:[(0,q.jsx)(m.A,{children:"Gender Preference"}),(0,q.jsxs)(je.D0,{as:y.A,name:"preferences.gender",label:"Gender Preference",value:oe.preferences.gender,onChange:xe,children:[(0,q.jsx)(A.A,{value:"",children:"No Preference"}),(0,q.jsx)(A.A,{value:"male",children:"Male"}),(0,q.jsx)(A.A,{value:"female",children:"Female"}),(0,q.jsx)(A.A,{value:"any",children:"Any"})]})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,children:[(0,q.jsx)(m.A,{children:"Occupation Preference"}),(0,q.jsxs)(je.D0,{as:y.A,name:"preferences.occupation",label:"Occupation Preference",value:oe.preferences.occupation,onChange:xe,children:[(0,q.jsx)(A.A,{value:"",children:"No Preference"}),(0,q.jsx)(A.A,{value:"student",children:"Student"}),(0,q.jsx)(A.A,{value:"professional",children:"Professional"}),(0,q.jsx)(A.A,{value:"other",children:"Other"})]})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,children:[(0,q.jsx)(m.A,{children:"Lifestyle Preference"}),(0,q.jsxs)(je.D0,{as:y.A,name:"preferences.lifestyle",label:"Lifestyle Preference",value:oe.preferences.lifestyle,onChange:xe,children:[(0,q.jsx)(A.A,{value:"",children:"No Preference"}),(0,q.jsx)(A.A,{value:"quiet",children:"Quiet"}),(0,q.jsx)(A.A,{value:"social",children:"Social"}),(0,q.jsx)(A.A,{value:"family",children:"Family-oriented"})]})]})}),(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(je.D0,{as:d.A,fullWidth:!0,label:"Age Range Preference",name:"preferences.ageRange",placeholder:"e.g. 20-30",value:oe.preferences.ageRange,onChange:xe})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Images"})]}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsxs)(n.A,{sx:{mb:2,p:2,border:D.some(e=>e.includes("image"))?"2px solid #d32f2f":"1px solid #e0e0e0",borderRadius:1,backgroundColor:D.some(e=>e.includes("image"))?"#ffebee":"transparent"},children:[(0,q.jsxs)(g.A,{variant:"outlined",component:"label",startIcon:(0,q.jsx)(Se.A,{}),disabled:P.length>=5,children:["Upload Images",(0,q.jsx)("input",{type:"file",hidden:!0,accept:"image/*",multiple:!0,onChange:E})]}),(0,q.jsxs)(o.A,{variant:"caption",display:"block",sx:{mt:1,color:D.some(e=>e.includes("image"))?"#d32f2f":"text.secondary"},children:[D.some(e=>e.includes("image"))?"\u26a0\ufe0f ":"","Max 5 images. Supported formats: JPEG, JPG, PNG. Max size: 5MB per image.",!k&&" (Required)"]})]}),(0,q.jsx)(p.Ay,{container:!0,spacing:2,children:P.map((e,r)=>(0,q.jsx)(p.Ay,{item:!0,xs:6,sm:4,md:3,children:(0,q.jsxs)(f.A,{children:[(0,q.jsx)(b.A,{component:"img",height:"140",image:e,alt:"Property image ".concat(r+1)}),(0,q.jsx)(le.A,{children:(0,q.jsx)(g.A,{size:"small",color:"error",startIcon:(0,q.jsx)(Pe.A,{}),onClick:()=>(e=>{var r,t;if(k&&e<((null===i||void 0===i||null===(r=i.images)||void 0===r?void 0:r.length)||0)){var s;const r=null===i||void 0===i||null===(s=i.images)||void 0===s?void 0:s[e];return r&&_([...T,r]),void w(P.filter((r,t)=>t!==e))}const n=k?e-((null===i||void 0===i||null===(t=i.images)||void 0===t?void 0:t.length)||0):e;if(n>=0){const e=[...j];e.splice(n,1),v(e)}w(P.filter((r,t)=>t!==e))})(r),children:"Remove"})})]})},r))})]}),(0,q.jsx)(p.Ay,{item:!0,xs:12,children:(0,q.jsxs)(o.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",mt:3,mb:1},children:["By listing your property, you agree to our"," ",(0,q.jsx)(fe.A,{component:S.N_,to:"/privacy",target:"_blank",color:"primary",children:"Privacy Policy"}),". Your contact details will only be visible to verified users."]})}),(0,q.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,q.jsx)(ie.A,{sx:{my:2}}),(0,q.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[(0,q.jsx)(g.A,{variant:"outlined",onClick:()=>r(-1),children:"Cancel"}),(0,q.jsx)(g.A,{type:"submit",variant:"contained",disabled:B,startIcon:B?(0,q.jsx)(l.A,{size:20}):(0,q.jsx)(Ce.A,{}),children:B?"Submitting...":k?"Update Property":"Create Property"})]})]})]})})}})})]})},Te=()=>(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsxs)(x.A,{elevation:3,sx:{p:4},children:[(0,q.jsxs)(n.A,{sx:{mb:4},children:[(0,q.jsx)(o.A,{variant:"h3",component:"h1",gutterBottom:!0,children:"List Your Property"}),(0,q.jsx)(o.A,{variant:"subtitle1",color:"text.secondary",children:"Find the perfect flatmate for your property"})]}),(0,q.jsx)(we,{})]})}),_e=()=>{var e;const{property:r,loading:t,error:s}=(0,te.d4)(e=>e.property),{user:d}=(0,te.d4)(e=>e.auth);return t?(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,q.jsx)(l.A,{})})}):s?(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsx)(a.A,{severity:"error",children:String(s)})}):r?(null===(e=r.owner)||void 0===e?void 0:e._id)!==(null===d||void 0===d?void 0:d._id)?(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsx)(a.A,{severity:"error",children:"You are not authorized to edit this property"})}):(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsxs)(x.A,{elevation:3,sx:{p:4},children:[(0,q.jsxs)(n.A,{sx:{mb:4},children:[(0,q.jsx)(o.A,{variant:"h3",component:"h1",gutterBottom:!0,children:"Edit Property"}),(0,q.jsx)(o.A,{variant:"subtitle1",color:"text.secondary",children:"Update your property details"})]}),(0,q.jsx)(we,{})]})}):(0,q.jsx)(i.A,{maxWidth:"md",sx:{py:4},children:(0,q.jsx)(a.A,{severity:"info",children:"Property not found"})})};var Be=t(3159),We=t(7260);const De=()=>{const e=(0,te.wA)(),{userListings:r,loading:t,error:d}=(0,te.d4)(e=>e.property);return(0,s.useEffect)(()=>{e((0,ee.pu)())},[e]),t?(0,q.jsx)(i.A,{maxWidth:"lg",sx:{py:4},children:(0,q.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,q.jsx)(l.A,{})})}):d?(0,q.jsx)(i.A,{maxWidth:"lg",sx:{py:4},children:(0,q.jsx)(a.A,{severity:"error",children:"string"===typeof d?d:d.msg||"An error occurred"})}):(0,q.jsxs)(i.A,{maxWidth:"lg",sx:{py:4},children:[(0,q.jsxs)(n.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,q.jsx)(o.A,{variant:"h3",component:"h1",children:"My Listings"}),(0,q.jsx)(g.A,{component:S.N_,to:"/properties/create",variant:"contained",startIcon:(0,q.jsx)(Ce.A,{}),children:"Add New Property"})]}),r&&r.length>0?(0,q.jsx)(p.Ay,{container:!0,spacing:3,children:r.map(e=>{var r,t;return(0,q.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,q.jsxs)(f.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,q.jsx)(b.A,{component:"img",height:"200",image:null!==(r=e.images)&&void 0!==r&&null!==(t=r[0])&&void 0!==t&&t.url?e.images[0].url.startsWith("http")?e.images[0].url:"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"").concat(e.images[0].url):"https://picsum.photos/seed/no-image-listing/300/200",alt:"Property listing: ".concat(e.title),loading:"lazy"}),(0,q.jsxs)(P.A,{sx:{flexGrow:1},children:[(0,q.jsxs)(n.A,{sx:{mb:1},children:[(0,q.jsx)(C.A,{label:e.status||"Active",color:"inactive"===e.status?"default":"success",size:"small",sx:{mr:1}}),(0,q.jsx)(C.A,{label:e.propertyType,size:"small"})]}),(0,q.jsx)(o.A,{gutterBottom:!0,variant:"h5",component:"h2",children:e.title}),(0,q.jsxs)(o.A,{variant:"body2",color:"text.secondary",paragraph:!0,children:[e.address.city,", ",e.address.state]}),(0,q.jsxs)(o.A,{variant:"h6",color:"primary",children:["\u20b9",e.price.amount]})]}),(0,q.jsxs)(le.A,{children:[(0,q.jsx)(g.A,{size:"small",startIcon:(0,q.jsx)(We.A,{}),component:S.N_,to:"/properties/".concat(e._id),children:"View"}),(0,q.jsx)(g.A,{size:"small",startIcon:(0,q.jsx)(Be.A,{}),component:S.N_,to:"/properties/edit/".concat(e._id),children:"Edit"})]})]})},e._id)})}):(0,q.jsxs)(n.A,{sx:{textAlign:"center",py:8},children:[(0,q.jsx)(o.A,{variant:"h5",color:"text.secondary",gutterBottom:!0,children:"You haven't created any listings yet."}),(0,q.jsx)(g.A,{component:S.N_,to:"/properties/create",variant:"contained",startIcon:(0,q.jsx)(Ce.A,{}),sx:{mt:2},children:"Create Your First Listing"})]})]})}},4021:(e,r,t)=>{t.d(r,{A:()=>W});var s=t(5043),i=t(9456),n=t(3216),l=t(8012),a=t(8202),o=t(9722),d=t(35),c=t(6600),x=t(5316),p=t(9347),h=t(7784),u=t(1906),m=t(3336),y=t(5721),A=t(4628),j=t(3851),v=t(8734),g=t(1045),f=t(5865),b=t(1637),C=t(1787),P=t(3845),S=t(6446),w=t(6360),T=t(2177),_=t(3639),B=t(579);const W=e=>{let{open:r,onClose:t,propertyId:W=null,ownerId:D=null}=e;const I=(0,a.jL)(),z=(0,n.Zp)(),k=(0,n.zy)(),{user:E}=(0,i.d4)(e=>e.auth),[L,R]=(0,s.useState)(""),[F,N]=(0,s.useState)([]),[O,q]=(0,s.useState)(null),[U,H]=(0,s.useState)(""),[Y,V]=(0,s.useState)(!1),[G,M]=(0,s.useState)(!1),[K,Z]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{if(D&&!O&&r)try{V(!0);const e=(await o.A.get("/api/users/".concat(D))).data;q(e),W&&!U&&H("Hi! I'm interested in your property. Could you tell me more about it?")}catch(e){console.error("Error fetching owner details:",e),Z("Unable to load property owner information. Please search manually.")}finally{V(!1)}})()},[D,O,r,W,U]),(0,s.useEffect)(()=>{const e=new URLSearchParams(k.search);e.get("propertyId"),e.get("ownerId")},[k.search,W,D]),(0,s.useEffect)(()=>{const e=setTimeout(async()=>{if(L.trim().length<2)N([]);else{M(!0);try{const e=(await o.A.get("/api/users",{params:{search:L}})).data.users.filter(e=>e._id!==(null===E||void 0===E?void 0:E._id));N(e)}catch(e){console.error("Error searching users:",e),N([])}finally{M(!1)}}},300);return()=>clearTimeout(e)},[L,E]),(0,s.useEffect)(()=>{r||(R(""),N([]),q(null),H(""),Z(""))},[r]);const J=()=>{t()};return(0,B.jsxs)(d.A,{open:r,onClose:J,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsxs)(c.A,{children:["New Conversation",W&&(0,B.jsx)(P.A,{icon:(0,B.jsx)(_.A,{}),label:"Property Related",size:"small",color:"primary",sx:{ml:1}})]}),(0,B.jsxs)(x.A,{children:[O?(0,B.jsxs)(S.A,{children:[(0,B.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",mb:2,p:1,bgcolor:"grey.100",borderRadius:1},children:[(0,B.jsx)(g.A,{src:O.avatar,alt:O.name,sx:{mr:2},children:!O.avatar&&(0,B.jsx)(T.A,{})}),(0,B.jsxs)(S.A,{children:[(0,B.jsx)(f.A,{variant:"subtitle1",children:O.name}),(0,B.jsx)(f.A,{variant:"body2",color:"text.secondary",children:O.userType})]}),(0,B.jsx)(u.A,{size:"small",onClick:()=>q(null),sx:{ml:"auto"},children:"Change"})]}),(0,B.jsx)(h.A,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",placeholder:"Type your message here...",value:U,onChange:e=>H(e.target.value),sx:{mb:2}}),W&&(0,B.jsx)(f.A,{variant:"caption",color:"text.secondary",children:"This conversation is related to a property listing"})]}):(0,B.jsxs)(S.A,{children:[(0,B.jsx)(h.A,{fullWidth:!0,variant:"outlined",placeholder:"Search users by name...",value:L,onChange:e=>R(e.target.value),InputProps:{startAdornment:(0,B.jsx)(C.A,{position:"start",children:(0,B.jsx)(w.A,{})})},sx:{mb:2}}),G&&(0,B.jsx)(S.A,{sx:{display:"flex",justifyContent:"center",my:2},children:(0,B.jsx)(b.A,{size:24})}),F.length>0&&(0,B.jsx)(m.A,{elevation:2,sx:{maxHeight:200,overflow:"auto"},children:(0,B.jsx)(y.A,{children:F.map(e=>(0,B.jsxs)(A.Ay,{button:!0,onClick:()=>(e=>{q(e),R(""),N([]),W&&!U&&H("Hi! I'm interested in your property. Could you tell me more about it?")})(e),children:[(0,B.jsx)(j.A,{children:(0,B.jsx)(g.A,{src:e.avatar,alt:e.name,children:!e.avatar&&(0,B.jsx)(T.A,{})})}),(0,B.jsx)(v.A,{primary:e.name,secondary:e.userType})]},e._id))})}),L.length>=2&&0===F.length&&!G&&(0,B.jsx)(f.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",my:2},children:"No users found"})]}),K&&(0,B.jsx)(f.A,{color:"error",variant:"body2",sx:{mt:1},children:K})]}),(0,B.jsxs)(p.A,{children:[(0,B.jsx)(u.A,{onClick:J,children:"Cancel"}),(0,B.jsx)(u.A,{onClick:async()=>{if(O)if(U.trim()){V(!0),Z("");try{const e=await I((0,l.cK)({recipient:O._id,initialMessage:U.trim(),property:W||void 0})).unwrap();t(),z("/messages/".concat(e._id))}catch(e){console.error("Error creating conversation:",e),Z(e.message||"Failed to create conversation")}finally{V(!1)}}else Z("Please enter a message");else Z("Please select a user to message")},variant:"contained",disabled:!O||!U.trim()||Y,children:Y?(0,B.jsx)(b.A,{size:24}):"Start Conversation"})]})]})}}}]);
//# sourceMappingURL=811.668f1681.chunk.js.map